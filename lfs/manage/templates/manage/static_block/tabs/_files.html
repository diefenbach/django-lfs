{% load i18n %}

<h5 class="mb-3">{% trans 'Existing Files' %}</h5>

<div id="files-list">
    {% load i18n %}
    {% if static_block.files.all %}
        <form action="{% url 'lfs_manage_update_files_sb' static_block.id %}"
              method="post"
              class="mb-4">
            {% csrf_token %}    
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead>
                        <tr>
                            <th scope="col" width="40">
                                <div class="form-check">
                                    <input type="checkbox"
                                        class="form-check-input select-all"
                                        id="select-all-files"
                                        value="delete-files" />
                                    <label class="form-check-label visually-hidden" for="select-all-files">{% trans 'Select all' %}</label>
                                </div>
                            </th>
                            <th scope="col" width="80" class="text-end">{% trans 'Position' %}</th>
                            <th scope="col">{% trans 'Title' %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for file in static_block.files.all %}
                            <tr>
                                <td>
                                    <div class="form-check">
                                        <input type="checkbox"
                                            class="form-check-input select-delete-files"
                                            id="delete-file-{{ file.id }}"
                                            name="delete-{{ file.id }}" />
                                        <label class="form-check-label visually-hidden" for="delete-file-{{ file.id }}">{% trans 'Select file' %}</label>
                                    </div>
                                </td>
                                <td>
                                    <input type="number" name="position-{{ file.id }}" value="{{ file.position }}" class="form-control form-control-sm" min="0" />
                                </td>
                                <td>
                                    <input type="text" name="title-{{ file.id }}" value="{{ file.title }}" class="form-control" />
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <div class="d-flex gap-2 mt-3">
                <button type="submit" name="update" class="btn btn-primary">
                    <i class="bi bi-check-lg me-1"></i> {% trans 'Save Changes' %}
                </button>
                <button type="submit" name="delete" class="btn btn-danger">
                    <i class="bi bi-trash me-1"></i> {% trans 'Delete Selected Files' %}
                </button>
            </div>
        </form>
    {% else %}
        <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i> {% trans 'There are no files' %}
        </div>
    {% endif %}    
</div>

<hr class="my-4">

<h3 class="h5 mb-3">{% trans 'Add files' %}</h3>

<div id="file-upload-section">
    <form id="file_upload" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="mb-3">
            <input class="form-control" type="file" name="files[]" multiple accept="image/*">
        </div>
        <button class="btn btn-primary" type="submit">
            <i class="bi bi-upload me-1"></i>
            {% trans 'Upload files' %}
        </button>
    </form>
</div>
